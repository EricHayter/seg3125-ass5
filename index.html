<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Document</title>
    <link rel="stylesheet" href="style.css">
    <!-- Fun and interesting fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;700&family=Pacifico&family=Quicksand:wght@400;700&family=Winky+Rough&display=swap" rel="stylesheet">
    <!-- Chart.js and PapaParse from CDN -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
</head>
</head>
<nav class="lang-switcher">
    <a href="#" class="lang-btn">ESP 🇪🇸</a>
    <a href="#" class="lang-btn">ENG 🇬🇧</a>
</nav>
<body>
    <div class="main-column">
        <!-- Move bag-size-pie.js script to the end of the body for correct DOM access -->
        <h1>The Avo Index</h1>
        <p>
            The Avo Index is a comprehensive resource for avocado enthusiasts, providing detailed information on various avocado varieties, their characteristics, and culinary uses. Whether you're a chef looking to explore new flavors or a home cook wanting to learn more about this versatile fruit, the Avo Index has you covered.
        </p>

        <h2><span class="avo-emoji">🥑</span> Avocado Varieties <span class="avo-emoji">🥑</span></h2>
        <div class="varieties">
            <div class="variety">
                <div class="nickname">The Snackado</div>
                <p class="desc">The small/medium hass avocado</p>
                <div class="plu">PLU: 4046</div>
                <div class="weight">Weight: ~3-5 oz</div>
            </div>
            <div class="variety">
                <div class="nickname">The Brunch Boss</div>
                <p class="desc">The large hass avocado</p>
                <div class="plu">PLU: 4225</div>
                <div class="weight">Weight: ~8-10 oz</div>
            </div>
            <div class="variety">
                <div class="nickname">The Guac Giant</div>
                <p class="desc">The extra large hass avocado</p>
                <div class="plu">PLU: 4770</div>
                <div class="weight">Weight: ~10-15 oz</div>
            </div>
        </div>
        <!-- Pie chart for bag size proportions -->
        <section style="width:100%;max-width:500px;margin:2.5rem auto 1.5rem auto;">
            <h2 id="pieTitle" style="margin-bottom:1rem;">Avocado Sales by Bag Size</h2>
            <div style="margin-bottom:1rem;">
                <label id="yearLabel" for="yearSelect" style="font-weight:bold;">Year:</label>
                <select id="yearSelect" style="margin:0 1.5em 0 0;padding:0.3em 1em;border-radius:0.7em;border:1.5px solid #4CAF50;font-size:1.1em;"></select>
                <!-- Bag size checkboxes removed -->
            </div>
            <canvas id="bagSizePieChart"></canvas>
            <div id="pieBlurb" style="margin:0.7em 0 0.5em 0;font-size:1.08em;color:#5D4037;text-align:center;">This chart shows the proportion of avocados sold in each bag size for the selected year.</div>
        </section>

        <!-- Line chart for avocado price over time -->
        <section style="width:100%;max-width:500px;margin:2.5rem auto 1.5rem auto;">
            <h2 style="margin-bottom:1rem;">Avocado Price Over Time</h2>
            <div id="priceWindowContainer" style="margin:1.2rem 0 1.5rem 0;display:flex;flex-direction:column;align-items:center;">
                <div style="width:100%;max-width:420px;display:flex;align-items:center;gap:1em;">
                    <label for="priceWindowStart" style="font-weight:bold;">Start:</label>
                    <select id="priceWindowStart" style="flex:1;"></select>
                    <label for="priceWindowEnd" style="font-weight:bold;">End:</label>
                    <select id="priceWindowEnd" style="flex:1;"></select>
                </div>
            </div>
            <canvas id="priceLineChart"></canvas>
            <div id="lineBlurb" style="margin:0.7em 0 0.5em 0;font-size:1.08em;color:#5D4037;text-align:center;"></div>
        </section>
        </section>
        </div>
    </div>
    <!-- Load bag-size-pie.js after all DOM elements are available -->
    <script src="bag-size-pie.js"></script>
    <script src="price-line.js"></script>
    <script>
    // Language switching logic
    const translations = {
      en: {
        title: 'The Avo Index',
        desc: 'The Avo Index is a comprehensive resource for avocado enthusiasts, providing detailed information on various avocado varieties, their characteristics, and culinary uses. Whether you\'re a chef looking to explore new flavors or a home cook wanting to learn more about this versatile fruit, the Avo Index has you covered.',
        varieties: 'Avocado Varieties',
        snackado: 'The Snackado',
        snackadoDesc: 'The small/medium hass avocado',
        brunchboss: 'The Brunch Boss',
        brunchbossDesc: 'The large hass avocado',
        guacgiant: 'The Guac Giant',
        guacgiantDesc: 'The extra large hass avocado',
        weight1: 'Weight: ~3-5 oz',
        weight2: 'Weight: ~8-10 oz',
        weight3: 'Weight: ~10-15 oz',
        plu1: 'PLU: 4046',
        plu2: 'PLU: 4225',
        plu3: 'PLU: 4770',
        pieTitle: 'Avocado Sales by Bag Size',
        bagLabels: ['Small Bags', 'Large Bags', 'XLarge Bags'],
        year: 'Year:',
        lineTitle: 'Avocado Price Over Time',
        lineXAxis: 'Date',
        lineYAxis: 'Average Price (USD)',
        start: 'Start:',
        end: 'End:',
        pieBlurb: 'This chart shows the proportion of avocados sold in each bag size for the selected year.',
        lineBlurb: 'This chart displays the average price of avocados over time. Use the dropdowns to select a date range.',
      },
      es: {
        title: 'El Índice del Avo',
        desc: 'El Índice del Avo es un recurso integral para los entusiastas del aguacate, que proporciona información detallada sobre varias variedades de aguacate, sus características y usos culinarios. Ya sea que seas un chef buscando explorar nuevos sabores o un cocinero casero que quiera aprender más sobre esta fruta versátil, el Índice del Avo te cubre.',
        varieties: 'Variedades de Aguacate',
        snackado: 'El Bocadillo',
        snackadoDesc: 'El aguacate hass pequeño/mediano',
        brunchboss: 'El Jefe del Brunch',
        brunchbossDesc: 'El aguacate hass grande',
        guacgiant: 'El Gigante del Guac',
        guacgiantDesc: 'El aguacate hass extra grande',
        weight1: 'Peso: ~85-140 g',
        weight2: 'Peso: ~225-280 g',
        weight3: 'Peso: ~280-425 g',
        plu1: 'PLU: 4046',
        plu2: 'PLU: 4225',
        plu3: 'PLU: 4770',
        pieTitle: 'Ventas de Aguacate por Tamaño de Bolsa',
        bagLabels: ['Bolsas Pequeñas', 'Bolsas Grandes', 'Bolsas Extra Grandes'],
        year: 'Año:',
        lineTitle: 'Precio del Aguacate a lo Largo del Tiempo',
        lineXAxis: 'Fecha',
        lineYAxis: 'Precio Promedio (USD)',
        start: 'Inicio:',
        end: 'Fin:',
        pieBlurb: 'Este gráfico muestra la proporción de aguacates vendidos en cada tamaño de bolsa para el año seleccionado.',
        lineBlurb: 'Este gráfico muestra el precio promedio de los aguacates a lo largo del tiempo. Usa los menús para seleccionar un rango de fechas.',
      }
    };
    window.translations = translations;
    function setLang(lang) {
      const t = translations[lang];
      document.querySelector('h1').textContent = t.title;
      document.querySelector('.main-column > p').textContent = t.desc;
      document.querySelector('h2').innerHTML = `<span class="avo-emoji">🥑</span> ${t.varieties} <span class="avo-emoji">🥑</span>`;
      const vs = document.querySelectorAll('.variety');
      if (vs.length === 3) {
        vs[0].querySelector('.nickname').textContent = t.snackado;
        vs[0].querySelector('.desc').textContent = t.snackadoDesc;
        vs[0].querySelector('.plu').textContent = t.plu1;
        vs[0].querySelector('.weight').textContent = t.weight1;
        vs[1].querySelector('.nickname').textContent = t.brunchboss;
        vs[1].querySelector('.desc').textContent = t.brunchbossDesc;
        vs[1].querySelector('.plu').textContent = t.plu2;
        vs[1].querySelector('.weight').textContent = t.weight2;
        vs[2].querySelector('.nickname').textContent = t.guacgiant;
        vs[2].querySelector('.desc').textContent = t.guacgiantDesc;
        vs[2].querySelector('.plu').textContent = t.plu3;
        vs[2].querySelector('.weight').textContent = t.weight3;
      }
      // Pie chart section
      document.querySelector('section h2').textContent = t.pieTitle;
      document.querySelector('label[for="yearSelect"]').textContent = t.year;
      document.getElementById('pieBlurb').textContent = t.pieBlurb;
      // Update pie chart labels if chart exists
      if (window.setPieChartLabels) {
        window.setPieChartLabels(lang);
      }
      // Update line chart axis titles and dataset label if chart exists
      if (window.setLineChartLang) {
        window.setLineChartLang(lang);
      }
      // Update pie chart axis/title if needed (not typical for pie, but placeholder)
      if (window.pieChart && window.pieChart.options && window.pieChart.options.plugins && window.pieChart.options.plugins.title) {
        window.pieChart.options.plugins.title.text = t.pieTitle;
        window.pieChart.update();
      }
      // Line chart section
      const lineSection = document.querySelectorAll('section')[1];
      if (lineSection) {
        lineSection.querySelector('h2').textContent = t.lineTitle;
        const labels = lineSection.querySelectorAll('label');
        if (labels.length === 2) {
          labels[0].textContent = t.start;
          labels[1].textContent = t.end;
        }
        const blurb = lineSection.querySelector('#lineBlurb');
        if (blurb) blurb.textContent = t.lineBlurb;
      }
      // (Line chart axis/dataset update now handled by setLineChartLang)
    }
    document.querySelectorAll('.lang-btn')[0].addEventListener('click', function(e) {
      e.preventDefault();
      setLang('es');
      console.log('Language switched to: es');
    });
    document.querySelectorAll('.lang-btn')[1].addEventListener('click', function(e) {
      e.preventDefault();
      setLang('en');
      console.log('Language switched to: en');
    });
    // Default to English
    setLang('en');
    </script>
</body>
</html>
